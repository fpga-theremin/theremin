#include "synth_utils.h"
#include "../../common/src/synth_control.h"


// Sine interpolation table
static const float SIN_TABLE_1024[1025] {
    0.000000e+00f, 6.135885e-03f, 1.227154e-02f, 1.840673e-02f, 2.454123e-02f, 3.067480e-02f, 3.680722e-02f, 4.293826e-02f, // 0
    4.906767e-02f, 5.519524e-02f, 6.132074e-02f, 6.744392e-02f, 7.356456e-02f, 7.968244e-02f, 8.579731e-02f, 9.190896e-02f, // 8
    9.801714e-02f, 1.041216e-01f, 1.102222e-01f, 1.163186e-01f, 1.224107e-01f, 1.284981e-01f, 1.345807e-01f, 1.406582e-01f, // 16
    1.467305e-01f, 1.527972e-01f, 1.588581e-01f, 1.649131e-01f, 1.709619e-01f, 1.770042e-01f, 1.830399e-01f, 1.890687e-01f, // 24
    1.950903e-01f, 2.011046e-01f, 2.071114e-01f, 2.131103e-01f, 2.191012e-01f, 2.250839e-01f, 2.310581e-01f, 2.370236e-01f, // 32
    2.429802e-01f, 2.489276e-01f, 2.548657e-01f, 2.607941e-01f, 2.667128e-01f, 2.726214e-01f, 2.785197e-01f, 2.844075e-01f, // 40
    2.902847e-01f, 2.961509e-01f, 3.020059e-01f, 3.078496e-01f, 3.136817e-01f, 3.195020e-01f, 3.253103e-01f, 3.311063e-01f, // 48
    3.368899e-01f, 3.426607e-01f, 3.484187e-01f, 3.541635e-01f, 3.598950e-01f, 3.656130e-01f, 3.713172e-01f, 3.770074e-01f, // 56
    3.826834e-01f, 3.883450e-01f, 3.939920e-01f, 3.996242e-01f, 4.052413e-01f, 4.108432e-01f, 4.164296e-01f, 4.220003e-01f, // 64
    4.275551e-01f, 4.330938e-01f, 4.386162e-01f, 4.441221e-01f, 4.496113e-01f, 4.550836e-01f, 4.605387e-01f, 4.659765e-01f, // 72
    4.713967e-01f, 4.767992e-01f, 4.821838e-01f, 4.875502e-01f, 4.928982e-01f, 4.982277e-01f, 5.035384e-01f, 5.088301e-01f, // 80
    5.141027e-01f, 5.193560e-01f, 5.245897e-01f, 5.298036e-01f, 5.349976e-01f, 5.401715e-01f, 5.453250e-01f, 5.504580e-01f, // 88
    5.555702e-01f, 5.606616e-01f, 5.657318e-01f, 5.707807e-01f, 5.758082e-01f, 5.808140e-01f, 5.857979e-01f, 5.907597e-01f, // 96
    5.956993e-01f, 6.006165e-01f, 6.055110e-01f, 6.103828e-01f, 6.152316e-01f, 6.200572e-01f, 6.248595e-01f, 6.296382e-01f, // 104
    6.343933e-01f, 6.391244e-01f, 6.438315e-01f, 6.485144e-01f, 6.531728e-01f, 6.578067e-01f, 6.624158e-01f, 6.669999e-01f, // 112
    6.715590e-01f, 6.760927e-01f, 6.806010e-01f, 6.850837e-01f, 6.895405e-01f, 6.939715e-01f, 6.983762e-01f, 7.027547e-01f, // 120
    7.071068e-01f, 7.114322e-01f, 7.157308e-01f, 7.200025e-01f, 7.242471e-01f, 7.284644e-01f, 7.326543e-01f, 7.368166e-01f, // 128
    7.409511e-01f, 7.450578e-01f, 7.491364e-01f, 7.531868e-01f, 7.572088e-01f, 7.612024e-01f, 7.651673e-01f, 7.691033e-01f, // 136
    7.730105e-01f, 7.768885e-01f, 7.807372e-01f, 7.845566e-01f, 7.883464e-01f, 7.921066e-01f, 7.958369e-01f, 7.995373e-01f, // 144
    8.032075e-01f, 8.068476e-01f, 8.104572e-01f, 8.140363e-01f, 8.175848e-01f, 8.211025e-01f, 8.245893e-01f, 8.280450e-01f, // 152
    8.314696e-01f, 8.348629e-01f, 8.382247e-01f, 8.415550e-01f, 8.448536e-01f, 8.481203e-01f, 8.513552e-01f, 8.545580e-01f, // 160
    8.577286e-01f, 8.608669e-01f, 8.639729e-01f, 8.670462e-01f, 8.700870e-01f, 8.730950e-01f, 8.760701e-01f, 8.790122e-01f, // 168
    8.819213e-01f, 8.847971e-01f, 8.876396e-01f, 8.904487e-01f, 8.932243e-01f, 8.959662e-01f, 8.986745e-01f, 9.013488e-01f, // 176
    9.039893e-01f, 9.065957e-01f, 9.091680e-01f, 9.117060e-01f, 9.142098e-01f, 9.166791e-01f, 9.191139e-01f, 9.215140e-01f, // 184
    9.238795e-01f, 9.262102e-01f, 9.285061e-01f, 9.307670e-01f, 9.329928e-01f, 9.351835e-01f, 9.373390e-01f, 9.394592e-01f, // 192
    9.415441e-01f, 9.435935e-01f, 9.456073e-01f, 9.475856e-01f, 9.495282e-01f, 9.514350e-01f, 9.533060e-01f, 9.551412e-01f, // 200
    9.569403e-01f, 9.587035e-01f, 9.604305e-01f, 9.621214e-01f, 9.637761e-01f, 9.653944e-01f, 9.669765e-01f, 9.685221e-01f, // 208
    9.700313e-01f, 9.715039e-01f, 9.729400e-01f, 9.743394e-01f, 9.757021e-01f, 9.770281e-01f, 9.783174e-01f, 9.795698e-01f, // 216
    9.807853e-01f, 9.819639e-01f, 9.831055e-01f, 9.842101e-01f, 9.852776e-01f, 9.863081e-01f, 9.873014e-01f, 9.882576e-01f, // 224
    9.891765e-01f, 9.900582e-01f, 9.909026e-01f, 9.917098e-01f, 9.924795e-01f, 9.932119e-01f, 9.939070e-01f, 9.945646e-01f, // 232
    9.951847e-01f, 9.957674e-01f, 9.963126e-01f, 9.968203e-01f, 9.972905e-01f, 9.977231e-01f, 9.981181e-01f, 9.984756e-01f, // 240
    9.987955e-01f, 9.990777e-01f, 9.993224e-01f, 9.995294e-01f, 9.996988e-01f, 9.998306e-01f, 9.999247e-01f, 9.999812e-01f, // 248
    1.000000e+00f, 9.999812e-01f, 9.999247e-01f, 9.998306e-01f, 9.996988e-01f, 9.995294e-01f, 9.993224e-01f, 9.990777e-01f, // 256
    9.987955e-01f, 9.984756e-01f, 9.981181e-01f, 9.977231e-01f, 9.972905e-01f, 9.968203e-01f, 9.963126e-01f, 9.957674e-01f, // 264
    9.951847e-01f, 9.945646e-01f, 9.939070e-01f, 9.932119e-01f, 9.924795e-01f, 9.917098e-01f, 9.909026e-01f, 9.900582e-01f, // 272
    9.891765e-01f, 9.882576e-01f, 9.873014e-01f, 9.863081e-01f, 9.852776e-01f, 9.842101e-01f, 9.831055e-01f, 9.819639e-01f, // 280
    9.807853e-01f, 9.795698e-01f, 9.783174e-01f, 9.770281e-01f, 9.757021e-01f, 9.743394e-01f, 9.729400e-01f, 9.715039e-01f, // 288
    9.700313e-01f, 9.685221e-01f, 9.669765e-01f, 9.653944e-01f, 9.637761e-01f, 9.621214e-01f, 9.604305e-01f, 9.587035e-01f, // 296
    9.569403e-01f, 9.551412e-01f, 9.533060e-01f, 9.514350e-01f, 9.495282e-01f, 9.475856e-01f, 9.456073e-01f, 9.435935e-01f, // 304
    9.415441e-01f, 9.394592e-01f, 9.373390e-01f, 9.351835e-01f, 9.329928e-01f, 9.307670e-01f, 9.285061e-01f, 9.262102e-01f, // 312
    9.238795e-01f, 9.215140e-01f, 9.191139e-01f, 9.166791e-01f, 9.142098e-01f, 9.117060e-01f, 9.091680e-01f, 9.065957e-01f, // 320
    9.039893e-01f, 9.013488e-01f, 8.986745e-01f, 8.959662e-01f, 8.932243e-01f, 8.904487e-01f, 8.876396e-01f, 8.847971e-01f, // 328
    8.819213e-01f, 8.790122e-01f, 8.760701e-01f, 8.730950e-01f, 8.700870e-01f, 8.670462e-01f, 8.639729e-01f, 8.608669e-01f, // 336
    8.577286e-01f, 8.545580e-01f, 8.513552e-01f, 8.481203e-01f, 8.448536e-01f, 8.415550e-01f, 8.382247e-01f, 8.348629e-01f, // 344
    8.314696e-01f, 8.280450e-01f, 8.245893e-01f, 8.211025e-01f, 8.175848e-01f, 8.140363e-01f, 8.104572e-01f, 8.068476e-01f, // 352
    8.032075e-01f, 7.995373e-01f, 7.958369e-01f, 7.921066e-01f, 7.883464e-01f, 7.845566e-01f, 7.807372e-01f, 7.768885e-01f, // 360
    7.730105e-01f, 7.691033e-01f, 7.651673e-01f, 7.612024e-01f, 7.572088e-01f, 7.531868e-01f, 7.491364e-01f, 7.450578e-01f, // 368
    7.409511e-01f, 7.368166e-01f, 7.326543e-01f, 7.284644e-01f, 7.242471e-01f, 7.200025e-01f, 7.157308e-01f, 7.114322e-01f, // 376
    7.071068e-01f, 7.027547e-01f, 6.983762e-01f, 6.939715e-01f, 6.895405e-01f, 6.850837e-01f, 6.806010e-01f, 6.760927e-01f, // 384
    6.715590e-01f, 6.669999e-01f, 6.624158e-01f, 6.578067e-01f, 6.531728e-01f, 6.485144e-01f, 6.438315e-01f, 6.391244e-01f, // 392
    6.343933e-01f, 6.296382e-01f, 6.248595e-01f, 6.200572e-01f, 6.152316e-01f, 6.103828e-01f, 6.055110e-01f, 6.006165e-01f, // 400
    5.956993e-01f, 5.907597e-01f, 5.857979e-01f, 5.808140e-01f, 5.758082e-01f, 5.707807e-01f, 5.657318e-01f, 5.606616e-01f, // 408
    5.555702e-01f, 5.504580e-01f, 5.453250e-01f, 5.401715e-01f, 5.349976e-01f, 5.298036e-01f, 5.245897e-01f, 5.193560e-01f, // 416
    5.141027e-01f, 5.088301e-01f, 5.035384e-01f, 4.982277e-01f, 4.928982e-01f, 4.875502e-01f, 4.821838e-01f, 4.767992e-01f, // 424
    4.713967e-01f, 4.659765e-01f, 4.605387e-01f, 4.550836e-01f, 4.496113e-01f, 4.441221e-01f, 4.386162e-01f, 4.330938e-01f, // 432
    4.275551e-01f, 4.220003e-01f, 4.164296e-01f, 4.108432e-01f, 4.052413e-01f, 3.996242e-01f, 3.939920e-01f, 3.883450e-01f, // 440
    3.826834e-01f, 3.770074e-01f, 3.713172e-01f, 3.656130e-01f, 3.598950e-01f, 3.541635e-01f, 3.484187e-01f, 3.426607e-01f, // 448
    3.368899e-01f, 3.311063e-01f, 3.253103e-01f, 3.195020e-01f, 3.136817e-01f, 3.078496e-01f, 3.020059e-01f, 2.961509e-01f, // 456
    2.902847e-01f, 2.844075e-01f, 2.785197e-01f, 2.726214e-01f, 2.667128e-01f, 2.607941e-01f, 2.548657e-01f, 2.489276e-01f, // 464
    2.429802e-01f, 2.370236e-01f, 2.310581e-01f, 2.250839e-01f, 2.191012e-01f, 2.131103e-01f, 2.071114e-01f, 2.011046e-01f, // 472
    1.950903e-01f, 1.890687e-01f, 1.830399e-01f, 1.770042e-01f, 1.709619e-01f, 1.649131e-01f, 1.588581e-01f, 1.527972e-01f, // 480
    1.467305e-01f, 1.406582e-01f, 1.345807e-01f, 1.284981e-01f, 1.224107e-01f, 1.163186e-01f, 1.102222e-01f, 1.041216e-01f, // 488
    9.801714e-02f, 9.190896e-02f, 8.579731e-02f, 7.968244e-02f, 7.356456e-02f, 6.744392e-02f, 6.132074e-02f, 5.519524e-02f, // 496
    4.906767e-02f, 4.293826e-02f, 3.680722e-02f, 3.067480e-02f, 2.454123e-02f, 1.840673e-02f, 1.227154e-02f, 6.135885e-03f, // 504
    -2.068231e-13f, -6.135885e-03f, -1.227154e-02f, -1.840673e-02f, -2.454123e-02f, -3.067480e-02f, -3.680722e-02f, -4.293826e-02f, // 512
    -4.906767e-02f, -5.519524e-02f, -6.132074e-02f, -6.744392e-02f, -7.356456e-02f, -7.968244e-02f, -8.579731e-02f, -9.190896e-02f, // 520
    -9.801714e-02f, -1.041216e-01f, -1.102222e-01f, -1.163186e-01f, -1.224107e-01f, -1.284981e-01f, -1.345807e-01f, -1.406582e-01f, // 528
    -1.467305e-01f, -1.527972e-01f, -1.588581e-01f, -1.649131e-01f, -1.709619e-01f, -1.770042e-01f, -1.830399e-01f, -1.890687e-01f, // 536
    -1.950903e-01f, -2.011046e-01f, -2.071114e-01f, -2.131103e-01f, -2.191012e-01f, -2.250839e-01f, -2.310581e-01f, -2.370236e-01f, // 544
    -2.429802e-01f, -2.489276e-01f, -2.548657e-01f, -2.607941e-01f, -2.667128e-01f, -2.726214e-01f, -2.785197e-01f, -2.844075e-01f, // 552
    -2.902847e-01f, -2.961509e-01f, -3.020059e-01f, -3.078496e-01f, -3.136817e-01f, -3.195020e-01f, -3.253103e-01f, -3.311063e-01f, // 560
    -3.368899e-01f, -3.426607e-01f, -3.484187e-01f, -3.541635e-01f, -3.598950e-01f, -3.656130e-01f, -3.713172e-01f, -3.770074e-01f, // 568
    -3.826834e-01f, -3.883450e-01f, -3.939920e-01f, -3.996242e-01f, -4.052413e-01f, -4.108432e-01f, -4.164296e-01f, -4.220003e-01f, // 576
    -4.275551e-01f, -4.330938e-01f, -4.386162e-01f, -4.441221e-01f, -4.496113e-01f, -4.550836e-01f, -4.605387e-01f, -4.659765e-01f, // 584
    -4.713967e-01f, -4.767992e-01f, -4.821838e-01f, -4.875502e-01f, -4.928982e-01f, -4.982277e-01f, -5.035384e-01f, -5.088301e-01f, // 592
    -5.141027e-01f, -5.193560e-01f, -5.245897e-01f, -5.298036e-01f, -5.349976e-01f, -5.401715e-01f, -5.453250e-01f, -5.504580e-01f, // 600
    -5.555702e-01f, -5.606616e-01f, -5.657318e-01f, -5.707807e-01f, -5.758082e-01f, -5.808140e-01f, -5.857979e-01f, -5.907597e-01f, // 608
    -5.956993e-01f, -6.006165e-01f, -6.055110e-01f, -6.103828e-01f, -6.152316e-01f, -6.200572e-01f, -6.248595e-01f, -6.296382e-01f, // 616
    -6.343933e-01f, -6.391244e-01f, -6.438315e-01f, -6.485144e-01f, -6.531728e-01f, -6.578067e-01f, -6.624158e-01f, -6.669999e-01f, // 624
    -6.715590e-01f, -6.760927e-01f, -6.806010e-01f, -6.850837e-01f, -6.895405e-01f, -6.939715e-01f, -6.983762e-01f, -7.027547e-01f, // 632
    -7.071068e-01f, -7.114322e-01f, -7.157308e-01f, -7.200025e-01f, -7.242471e-01f, -7.284644e-01f, -7.326543e-01f, -7.368166e-01f, // 640
    -7.409511e-01f, -7.450578e-01f, -7.491364e-01f, -7.531868e-01f, -7.572088e-01f, -7.612024e-01f, -7.651673e-01f, -7.691033e-01f, // 648
    -7.730105e-01f, -7.768885e-01f, -7.807372e-01f, -7.845566e-01f, -7.883464e-01f, -7.921066e-01f, -7.958369e-01f, -7.995373e-01f, // 656
    -8.032075e-01f, -8.068476e-01f, -8.104572e-01f, -8.140363e-01f, -8.175848e-01f, -8.211025e-01f, -8.245893e-01f, -8.280450e-01f, // 664
    -8.314696e-01f, -8.348629e-01f, -8.382247e-01f, -8.415550e-01f, -8.448536e-01f, -8.481203e-01f, -8.513552e-01f, -8.545580e-01f, // 672
    -8.577286e-01f, -8.608669e-01f, -8.639729e-01f, -8.670462e-01f, -8.700870e-01f, -8.730950e-01f, -8.760701e-01f, -8.790122e-01f, // 680
    -8.819213e-01f, -8.847971e-01f, -8.876396e-01f, -8.904487e-01f, -8.932243e-01f, -8.959662e-01f, -8.986745e-01f, -9.013488e-01f, // 688
    -9.039893e-01f, -9.065957e-01f, -9.091680e-01f, -9.117060e-01f, -9.142098e-01f, -9.166791e-01f, -9.191139e-01f, -9.215140e-01f, // 696
    -9.238795e-01f, -9.262102e-01f, -9.285061e-01f, -9.307670e-01f, -9.329928e-01f, -9.351835e-01f, -9.373390e-01f, -9.394592e-01f, // 704
    -9.415441e-01f, -9.435935e-01f, -9.456073e-01f, -9.475856e-01f, -9.495282e-01f, -9.514350e-01f, -9.533060e-01f, -9.551412e-01f, // 712
    -9.569403e-01f, -9.587035e-01f, -9.604305e-01f, -9.621214e-01f, -9.637761e-01f, -9.653944e-01f, -9.669765e-01f, -9.685221e-01f, // 720
    -9.700313e-01f, -9.715039e-01f, -9.729400e-01f, -9.743394e-01f, -9.757021e-01f, -9.770281e-01f, -9.783174e-01f, -9.795698e-01f, // 728
    -9.807853e-01f, -9.819639e-01f, -9.831055e-01f, -9.842101e-01f, -9.852776e-01f, -9.863081e-01f, -9.873014e-01f, -9.882576e-01f, // 736
    -9.891765e-01f, -9.900582e-01f, -9.909026e-01f, -9.917098e-01f, -9.924795e-01f, -9.932119e-01f, -9.939070e-01f, -9.945646e-01f, // 744
    -9.951847e-01f, -9.957674e-01f, -9.963126e-01f, -9.968203e-01f, -9.972905e-01f, -9.977231e-01f, -9.981181e-01f, -9.984756e-01f, // 752
    -9.987955e-01f, -9.990777e-01f, -9.993224e-01f, -9.995294e-01f, -9.996988e-01f, -9.998306e-01f, -9.999247e-01f, -9.999812e-01f, // 760
    -1.000000e+00f, -9.999812e-01f, -9.999247e-01f, -9.998306e-01f, -9.996988e-01f, -9.995294e-01f, -9.993224e-01f, -9.990777e-01f, // 768
    -9.987955e-01f, -9.984756e-01f, -9.981181e-01f, -9.977231e-01f, -9.972905e-01f, -9.968203e-01f, -9.963126e-01f, -9.957674e-01f, // 776
    -9.951847e-01f, -9.945646e-01f, -9.939070e-01f, -9.932119e-01f, -9.924795e-01f, -9.917098e-01f, -9.909026e-01f, -9.900582e-01f, // 784
    -9.891765e-01f, -9.882576e-01f, -9.873014e-01f, -9.863081e-01f, -9.852776e-01f, -9.842101e-01f, -9.831055e-01f, -9.819639e-01f, // 792
    -9.807853e-01f, -9.795698e-01f, -9.783174e-01f, -9.770281e-01f, -9.757021e-01f, -9.743394e-01f, -9.729400e-01f, -9.715039e-01f, // 800
    -9.700313e-01f, -9.685221e-01f, -9.669765e-01f, -9.653944e-01f, -9.637761e-01f, -9.621214e-01f, -9.604305e-01f, -9.587035e-01f, // 808
    -9.569403e-01f, -9.551412e-01f, -9.533060e-01f, -9.514350e-01f, -9.495282e-01f, -9.475856e-01f, -9.456073e-01f, -9.435935e-01f, // 816
    -9.415441e-01f, -9.394592e-01f, -9.373390e-01f, -9.351835e-01f, -9.329928e-01f, -9.307670e-01f, -9.285061e-01f, -9.262102e-01f, // 824
    -9.238795e-01f, -9.215140e-01f, -9.191139e-01f, -9.166791e-01f, -9.142098e-01f, -9.117060e-01f, -9.091680e-01f, -9.065957e-01f, // 832
    -9.039893e-01f, -9.013488e-01f, -8.986745e-01f, -8.959662e-01f, -8.932243e-01f, -8.904487e-01f, -8.876396e-01f, -8.847971e-01f, // 840
    -8.819213e-01f, -8.790122e-01f, -8.760701e-01f, -8.730950e-01f, -8.700870e-01f, -8.670462e-01f, -8.639729e-01f, -8.608669e-01f, // 848
    -8.577286e-01f, -8.545580e-01f, -8.513552e-01f, -8.481203e-01f, -8.448536e-01f, -8.415550e-01f, -8.382247e-01f, -8.348629e-01f, // 856
    -8.314696e-01f, -8.280450e-01f, -8.245893e-01f, -8.211025e-01f, -8.175848e-01f, -8.140363e-01f, -8.104572e-01f, -8.068476e-01f, // 864
    -8.032075e-01f, -7.995373e-01f, -7.958369e-01f, -7.921066e-01f, -7.883464e-01f, -7.845566e-01f, -7.807372e-01f, -7.768885e-01f, // 872
    -7.730105e-01f, -7.691033e-01f, -7.651673e-01f, -7.612024e-01f, -7.572088e-01f, -7.531868e-01f, -7.491364e-01f, -7.450578e-01f, // 880
    -7.409511e-01f, -7.368166e-01f, -7.326543e-01f, -7.284644e-01f, -7.242471e-01f, -7.200025e-01f, -7.157308e-01f, -7.114322e-01f, // 888
    -7.071068e-01f, -7.027547e-01f, -6.983762e-01f, -6.939715e-01f, -6.895405e-01f, -6.850837e-01f, -6.806010e-01f, -6.760927e-01f, // 896
    -6.715590e-01f, -6.669999e-01f, -6.624158e-01f, -6.578067e-01f, -6.531728e-01f, -6.485144e-01f, -6.438315e-01f, -6.391244e-01f, // 904
    -6.343933e-01f, -6.296382e-01f, -6.248595e-01f, -6.200572e-01f, -6.152316e-01f, -6.103828e-01f, -6.055110e-01f, -6.006165e-01f, // 912
    -5.956993e-01f, -5.907597e-01f, -5.857979e-01f, -5.808140e-01f, -5.758082e-01f, -5.707807e-01f, -5.657318e-01f, -5.606616e-01f, // 920
    -5.555702e-01f, -5.504580e-01f, -5.453250e-01f, -5.401715e-01f, -5.349976e-01f, -5.298036e-01f, -5.245897e-01f, -5.193560e-01f, // 928
    -5.141027e-01f, -5.088301e-01f, -5.035384e-01f, -4.982277e-01f, -4.928982e-01f, -4.875502e-01f, -4.821838e-01f, -4.767992e-01f, // 936
    -4.713967e-01f, -4.659765e-01f, -4.605387e-01f, -4.550836e-01f, -4.496113e-01f, -4.441221e-01f, -4.386162e-01f, -4.330938e-01f, // 944
    -4.275551e-01f, -4.220003e-01f, -4.164296e-01f, -4.108432e-01f, -4.052413e-01f, -3.996242e-01f, -3.939920e-01f, -3.883450e-01f, // 952
    -3.826834e-01f, -3.770074e-01f, -3.713172e-01f, -3.656130e-01f, -3.598950e-01f, -3.541635e-01f, -3.484187e-01f, -3.426607e-01f, // 960
    -3.368899e-01f, -3.311063e-01f, -3.253103e-01f, -3.195020e-01f, -3.136817e-01f, -3.078496e-01f, -3.020059e-01f, -2.961509e-01f, // 968
    -2.902847e-01f, -2.844075e-01f, -2.785197e-01f, -2.726214e-01f, -2.667128e-01f, -2.607941e-01f, -2.548657e-01f, -2.489276e-01f, // 976
    -2.429802e-01f, -2.370236e-01f, -2.310581e-01f, -2.250839e-01f, -2.191012e-01f, -2.131103e-01f, -2.071114e-01f, -2.011046e-01f, // 984
    -1.950903e-01f, -1.890687e-01f, -1.830399e-01f, -1.770042e-01f, -1.709619e-01f, -1.649131e-01f, -1.588581e-01f, -1.527972e-01f, // 992
    -1.467305e-01f, -1.406582e-01f, -1.345807e-01f, -1.284981e-01f, -1.224107e-01f, -1.163186e-01f, -1.102222e-01f, -1.041216e-01f, // 1000
    -9.801714e-02f, -9.190896e-02f, -8.579731e-02f, -7.968244e-02f, -7.356456e-02f, -6.744392e-02f, -6.132074e-02f, -5.519524e-02f, // 1008
    -4.906767e-02f, -4.293826e-02f, -3.680722e-02f, -3.067480e-02f, -2.454123e-02f, -1.840673e-02f, -1.227154e-02f, -6.135885e-03f, // 1016
    4.136462e-13f, // 1024
};


// Sine interpolation table - int24
static const int32_t SIN_TABLE_1024_I[1025] {
    0, 51472, 102941, 154407, 205867, 257319, 308761, 360192, // 0
    411609, 463011, 514396, 565761, 617104, 668425, 719720, 770988, // 8
    822227, 873435, 924611, 975751, 1026855, 1077920, 1128945, 1179927, // 16
    1230864, 1281756, 1332599, 1383391, 1434132, 1484819, 1535450, 1586023, // 24
    1636536, 1686988, 1737376, 1787699, 1837954, 1888140, 1938256, 1988298, // 32
    2038265, 2088156, 2137968, 2187699, 2237349, 2286913, 2336392, 2385783, // 40
    2435084, 2484293, 2533409, 2582430, 2631353, 2680177, 2728900, 2777521, // 48
    2826037, 2874446, 2922747, 2970939, 3019018, 3066984, 3114834, 3162567, // 56
    3210181, 3257674, 3305044, 3352290, 3399410, 3446402, 3493264, 3539994, // 64
    3586592, 3633054, 3679379, 3725566, 3771613, 3817517, 3863278, 3908894, // 72
    3954362, 3999681, 4044850, 4089867, 4134729, 4179436, 4223986, 4268376, // 80
    4312606, 4356673, 4400577, 4444314, 4487885, 4531286, 4574517, 4617576, // 88
    4660460, 4703170, 4745702, 4788055, 4830229, 4872220, 4914028, 4955651, // 96
    4997087, 5038336, 5079394, 5120261, 5160936, 5201416, 5241701, 5281788, // 104
    5321676, 5361364, 5400850, 5440132, 5479210, 5518082, 5556746, 5595200, // 112
    5633444, 5671476, 5709294, 5746898, 5784285, 5821454, 5858404, 5895133, // 120
    5931641, 5967925, 6003985, 6039818, 6075424, 6110801, 6145949, 6180865, // 128
    6215548, 6249997, 6284211, 6318188, 6351927, 6385428, 6418687, 6451706, // 136
    6484481, 6517012, 6549298, 6581337, 6613128, 6644671, 6675963, 6707004, // 144
    6737792, 6768327, 6798607, 6828631, 6858398, 6887906, 6917156, 6946144, // 152
    6974872, 7003337, 7031538, 7059474, 7087145, 7114548, 7141684, 7168551, // 160
    7195148, 7221474, 7247529, 7273310, 7298818, 7324051, 7349008, 7373688, // 168
    7398091, 7422215, 7446060, 7469624, 7492908, 7515909, 7538627, 7561061, // 176
    7583211, 7605075, 7626653, 7647944, 7668946, 7689660, 7710085, 7730219, // 184
    7750062, 7769614, 7788873, 7807838, 7826510, 7844887, 7862969, 7880754, // 192
    7898243, 7915435, 7932328, 7948923, 7965219, 7981214, 7996910, 8012304, // 200
    8027396, 8042187, 8056674, 8070858, 8084739, 8098315, 8111586, 8124551, // 208
    8137211, 8149564, 8161611, 8173350, 8184782, 8195905, 8206720, 8217226, // 216
    8227422, 8237309, 8246886, 8256152, 8265107, 8273751, 8282084, 8290104, // 224
    8297813, 8305209, 8312293, 8319063, 8325521, 8331665, 8337495, 8343011, // 232
    8348214, 8353102, 8357675, 8361934, 8365878, 8369507, 8372821, 8375819, // 240
    8378503, 8380870, 8382923, 8384659, 8386081, 8387186, 8387975, 8388449, // 248
    8388607, 8388449, 8387975, 8387186, 8386081, 8384659, 8382923, 8380870, // 256
    8378503, 8375819, 8372821, 8369507, 8365878, 8361934, 8357675, 8353102, // 264
    8348214, 8343011, 8337495, 8331665, 8325521, 8319063, 8312293, 8305209, // 272
    8297813, 8290104, 8282084, 8273751, 8265107, 8256152, 8246886, 8237309, // 280
    8227422, 8217226, 8206720, 8195905, 8184782, 8173350, 8161611, 8149564, // 288
    8137211, 8124551, 8111586, 8098315, 8084739, 8070858, 8056674, 8042187, // 296
    8027396, 8012304, 7996910, 7981214, 7965219, 7948923, 7932328, 7915435, // 304
    7898243, 7880754, 7862969, 7844887, 7826510, 7807838, 7788873, 7769614, // 312
    7750062, 7730219, 7710085, 7689660, 7668946, 7647944, 7626653, 7605075, // 320
    7583211, 7561061, 7538627, 7515909, 7492908, 7469624, 7446060, 7422215, // 328
    7398091, 7373688, 7349008, 7324051, 7298818, 7273310, 7247529, 7221474, // 336
    7195148, 7168551, 7141684, 7114548, 7087145, 7059474, 7031538, 7003337, // 344
    6974872, 6946144, 6917156, 6887906, 6858398, 6828631, 6798607, 6768327, // 352
    6737792, 6707004, 6675963, 6644671, 6613128, 6581337, 6549298, 6517012, // 360
    6484481, 6451706, 6418687, 6385428, 6351927, 6318188, 6284211, 6249997, // 368
    6215548, 6180865, 6145949, 6110801, 6075424, 6039818, 6003985, 5967925, // 376
    5931641, 5895133, 5858404, 5821454, 5784285, 5746898, 5709294, 5671476, // 384
    5633444, 5595200, 5556746, 5518082, 5479210, 5440132, 5400850, 5361364, // 392
    5321676, 5281788, 5241701, 5201416, 5160936, 5120261, 5079394, 5038336, // 400
    4997087, 4955651, 4914028, 4872220, 4830229, 4788055, 4745702, 4703170, // 408
    4660460, 4617576, 4574517, 4531286, 4487885, 4444314, 4400577, 4356673, // 416
    4312606, 4268376, 4223986, 4179436, 4134729, 4089867, 4044850, 3999681, // 424
    3954362, 3908894, 3863278, 3817517, 3771613, 3725566, 3679379, 3633054, // 432
    3586592, 3539994, 3493264, 3446402, 3399410, 3352290, 3305044, 3257674, // 440
    3210181, 3162567, 3114834, 3066984, 3019018, 2970939, 2922747, 2874446, // 448
    2826037, 2777521, 2728900, 2680177, 2631353, 2582430, 2533409, 2484293, // 456
    2435084, 2385783, 2336392, 2286913, 2237349, 2187699, 2137968, 2088156, // 464
    2038265, 1988298, 1938256, 1888140, 1837954, 1787699, 1737376, 1686988, // 472
    1636536, 1586023, 1535450, 1484819, 1434132, 1383391, 1332599, 1281756, // 480
    1230864, 1179927, 1128945, 1077920, 1026855, 975751, 924611, 873435, // 488
    822227, 770988, 719720, 668425, 617104, 565761, 514396, 463011, // 496
    411609, 360192, 308761, 257319, 205867, 154407, 102941, 51472, // 504
    0, -51471, -102940, -154406, -205866, -257318, -308760, -360191, // 512
    -411608, -463010, -514395, -565760, -617103, -668424, -719719, -770987, // 520
    -822226, -873434, -924610, -975750, -1026854, -1077919, -1128944, -1179926, // 528
    -1230863, -1281755, -1332598, -1383390, -1434131, -1484818, -1535449, -1586022, // 536
    -1636535, -1686987, -1737375, -1787698, -1837953, -1888139, -1938255, -1988297, // 544
    -2038264, -2088155, -2137967, -2187698, -2237348, -2286912, -2336391, -2385782, // 552
    -2435083, -2484292, -2533408, -2582429, -2631352, -2680176, -2728899, -2777520, // 560
    -2826036, -2874445, -2922746, -2970938, -3019017, -3066983, -3114833, -3162566, // 568
    -3210180, -3257673, -3305043, -3352289, -3399409, -3446401, -3493263, -3539993, // 576
    -3586591, -3633053, -3679378, -3725565, -3771612, -3817516, -3863277, -3908893, // 584
    -3954361, -3999680, -4044849, -4089866, -4134728, -4179435, -4223985, -4268375, // 592
    -4312605, -4356672, -4400576, -4444313, -4487884, -4531285, -4574516, -4617575, // 600
    -4660459, -4703169, -4745701, -4788054, -4830228, -4872219, -4914027, -4955650, // 608
    -4997086, -5038335, -5079393, -5120260, -5160935, -5201415, -5241700, -5281787, // 616
    -5321675, -5361363, -5400849, -5440131, -5479209, -5518081, -5556745, -5595199, // 624
    -5633443, -5671475, -5709293, -5746897, -5784284, -5821453, -5858403, -5895132, // 632
    -5931640, -5967924, -6003984, -6039817, -6075423, -6110800, -6145948, -6180864, // 640
    -6215547, -6249996, -6284210, -6318187, -6351926, -6385427, -6418686, -6451705, // 648
    -6484480, -6517011, -6549297, -6581336, -6613127, -6644670, -6675962, -6707003, // 656
    -6737791, -6768326, -6798606, -6828630, -6858397, -6887905, -6917155, -6946143, // 664
    -6974871, -7003336, -7031537, -7059473, -7087144, -7114547, -7141683, -7168550, // 672
    -7195147, -7221473, -7247528, -7273309, -7298817, -7324050, -7349007, -7373687, // 680
    -7398090, -7422214, -7446059, -7469623, -7492907, -7515908, -7538626, -7561060, // 688
    -7583210, -7605074, -7626652, -7647943, -7668945, -7689659, -7710084, -7730218, // 696
    -7750061, -7769613, -7788872, -7807837, -7826509, -7844886, -7862968, -7880753, // 704
    -7898242, -7915434, -7932327, -7948922, -7965218, -7981213, -7996909, -8012303, // 712
    -8027395, -8042186, -8056673, -8070857, -8084738, -8098314, -8111585, -8124550, // 720
    -8137210, -8149563, -8161610, -8173349, -8184781, -8195904, -8206719, -8217225, // 728
    -8227421, -8237308, -8246885, -8256151, -8265106, -8273750, -8282083, -8290103, // 736
    -8297812, -8305208, -8312292, -8319062, -8325520, -8331664, -8337494, -8343010, // 744
    -8348213, -8353101, -8357674, -8361933, -8365877, -8369506, -8372820, -8375818, // 752
    -8378502, -8380869, -8382922, -8384658, -8386080, -8387185, -8387974, -8388448, // 760
    -8388606, -8388448, -8387974, -8387185, -8386080, -8384658, -8382922, -8380869, // 768
    -8378502, -8375818, -8372820, -8369506, -8365877, -8361933, -8357674, -8353101, // 776
    -8348213, -8343010, -8337494, -8331664, -8325520, -8319062, -8312292, -8305208, // 784
    -8297812, -8290103, -8282083, -8273750, -8265106, -8256151, -8246885, -8237308, // 792
    -8227421, -8217225, -8206719, -8195904, -8184781, -8173349, -8161610, -8149563, // 800
    -8137210, -8124550, -8111585, -8098314, -8084738, -8070857, -8056673, -8042186, // 808
    -8027395, -8012303, -7996909, -7981213, -7965218, -7948922, -7932327, -7915434, // 816
    -7898242, -7880753, -7862968, -7844886, -7826509, -7807837, -7788872, -7769613, // 824
    -7750061, -7730218, -7710084, -7689659, -7668945, -7647943, -7626652, -7605074, // 832
    -7583210, -7561060, -7538626, -7515908, -7492907, -7469623, -7446059, -7422214, // 840
    -7398090, -7373687, -7349007, -7324050, -7298817, -7273309, -7247528, -7221473, // 848
    -7195147, -7168550, -7141683, -7114547, -7087144, -7059473, -7031537, -7003336, // 856
    -6974871, -6946143, -6917155, -6887905, -6858397, -6828630, -6798606, -6768326, // 864
    -6737791, -6707003, -6675962, -6644670, -6613127, -6581336, -6549297, -6517011, // 872
    -6484480, -6451705, -6418686, -6385427, -6351926, -6318187, -6284210, -6249996, // 880
    -6215547, -6180864, -6145948, -6110800, -6075423, -6039817, -6003984, -5967924, // 888
    -5931640, -5895132, -5858403, -5821453, -5784284, -5746897, -5709293, -5671475, // 896
    -5633443, -5595199, -5556745, -5518081, -5479209, -5440131, -5400849, -5361363, // 904
    -5321675, -5281787, -5241700, -5201415, -5160935, -5120260, -5079393, -5038335, // 912
    -4997086, -4955650, -4914027, -4872219, -4830228, -4788054, -4745701, -4703169, // 920
    -4660459, -4617575, -4574516, -4531285, -4487884, -4444313, -4400576, -4356672, // 928
    -4312605, -4268375, -4223985, -4179435, -4134728, -4089866, -4044849, -3999680, // 936
    -3954361, -3908893, -3863277, -3817516, -3771612, -3725565, -3679378, -3633053, // 944
    -3586591, -3539993, -3493263, -3446401, -3399409, -3352289, -3305043, -3257673, // 952
    -3210180, -3162566, -3114833, -3066983, -3019017, -2970938, -2922746, -2874445, // 960
    -2826036, -2777520, -2728899, -2680176, -2631352, -2582429, -2533408, -2484292, // 968
    -2435083, -2385782, -2336391, -2286912, -2237348, -2187698, -2137967, -2088155, // 976
    -2038264, -1988297, -1938255, -1888139, -1837953, -1787698, -1737375, -1686987, // 984
    -1636535, -1586022, -1535449, -1484818, -1434131, -1383390, -1332598, -1281755, // 992
    -1230863, -1179926, -1128944, -1077919, -1026854, -975750, -924610, -873434, // 1000
    -822226, -770987, -719719, -668424, -617103, -565760, -514395, -463010, // 1008
    -411608, -360191, -308760, -257318, -205866, -154406, -102940, -51471, // 1016
    0, // 1024
};


// Sine interpolation table - int16
static const int16_t SIN_TABLE_1024_I16[1025] {
    0, 201, 402, 603, 804, 1005, 1206, 1407, // 0
    1608, 1809, 2009, 2210, 2410, 2611, 2811, 3012, // 8
    3212, 3412, 3612, 3811, 4011, 4210, 4410, 4609, // 16
    4808, 5007, 5205, 5404, 5602, 5800, 5998, 6195, // 24
    6393, 6590, 6786, 6983, 7179, 7375, 7571, 7767, // 32
    7962, 8157, 8351, 8545, 8739, 8933, 9126, 9319, // 40
    9512, 9704, 9896, 10087, 10278, 10469, 10659, 10849, // 48
    11039, 11228, 11417, 11605, 11793, 11980, 12167, 12353, // 56
    12539, 12725, 12910, 13094, 13279, 13462, 13645, 13828, // 64
    14010, 14191, 14372, 14553, 14732, 14912, 15090, 15269, // 72
    15446, 15623, 15800, 15976, 16151, 16325, 16499, 16673, // 80
    16846, 17018, 17189, 17360, 17530, 17700, 17869, 18037, // 88
    18204, 18371, 18537, 18703, 18868, 19032, 19195, 19357, // 96
    19519, 19680, 19841, 20000, 20159, 20317, 20475, 20631, // 104
    20787, 20942, 21096, 21250, 21403, 21554, 21705, 21856, // 112
    22005, 22154, 22301, 22448, 22594, 22739, 22884, 23027, // 120
    23170, 23311, 23452, 23592, 23731, 23870, 24007, 24143, // 128
    24279, 24413, 24547, 24680, 24811, 24942, 25072, 25201, // 136
    25329, 25456, 25582, 25708, 25832, 25955, 26077, 26198, // 144
    26319, 26438, 26556, 26674, 26790, 26905, 27019, 27133, // 152
    27245, 27356, 27466, 27575, 27683, 27790, 27896, 28001, // 160
    28105, 28208, 28310, 28411, 28510, 28609, 28706, 28803, // 168
    28898, 28992, 29085, 29177, 29268, 29358, 29447, 29534, // 176
    29621, 29706, 29791, 29874, 29956, 30037, 30117, 30195, // 184
    30273, 30349, 30424, 30498, 30571, 30643, 30714, 30783, // 192
    30852, 30919, 30985, 31050, 31113, 31176, 31237, 31297, // 200
    31356, 31414, 31470, 31526, 31580, 31633, 31685, 31736, // 208
    31785, 31833, 31880, 31926, 31971, 32014, 32057, 32098, // 216
    32137, 32176, 32213, 32250, 32285, 32318, 32351, 32382, // 224
    32412, 32441, 32469, 32495, 32521, 32545, 32567, 32589, // 232
    32609, 32628, 32646, 32663, 32678, 32692, 32705, 32717, // 240
    32728, 32737, 32745, 32752, 32757, 32761, 32765, 32766, // 248
    32767, 32766, 32765, 32761, 32757, 32752, 32745, 32737, // 256
    32728, 32717, 32705, 32692, 32678, 32663, 32646, 32628, // 264
    32609, 32589, 32567, 32545, 32521, 32495, 32469, 32441, // 272
    32412, 32382, 32351, 32318, 32285, 32250, 32213, 32176, // 280
    32137, 32098, 32057, 32014, 31971, 31926, 31880, 31833, // 288
    31785, 31736, 31685, 31633, 31580, 31526, 31470, 31414, // 296
    31356, 31297, 31237, 31176, 31113, 31050, 30985, 30919, // 304
    30852, 30783, 30714, 30643, 30571, 30498, 30424, 30349, // 312
    30273, 30195, 30117, 30037, 29956, 29874, 29791, 29706, // 320
    29621, 29534, 29447, 29358, 29268, 29177, 29085, 28992, // 328
    28898, 28803, 28706, 28609, 28510, 28411, 28310, 28208, // 336
    28105, 28001, 27896, 27790, 27683, 27575, 27466, 27356, // 344
    27245, 27133, 27019, 26905, 26790, 26674, 26556, 26438, // 352
    26319, 26198, 26077, 25955, 25832, 25708, 25582, 25456, // 360
    25329, 25201, 25072, 24942, 24811, 24680, 24547, 24413, // 368
    24279, 24143, 24007, 23870, 23731, 23592, 23452, 23311, // 376
    23170, 23027, 22884, 22739, 22594, 22448, 22301, 22154, // 384
    22005, 21856, 21705, 21554, 21403, 21250, 21096, 20942, // 392
    20787, 20631, 20475, 20317, 20159, 20000, 19841, 19680, // 400
    19519, 19357, 19195, 19032, 18868, 18703, 18537, 18371, // 408
    18204, 18037, 17869, 17700, 17530, 17360, 17189, 17018, // 416
    16846, 16673, 16499, 16325, 16151, 15976, 15800, 15623, // 424
    15446, 15269, 15090, 14912, 14732, 14553, 14372, 14191, // 432
    14010, 13828, 13645, 13462, 13279, 13094, 12910, 12725, // 440
    12539, 12353, 12167, 11980, 11793, 11605, 11417, 11228, // 448
    11039, 10849, 10659, 10469, 10278, 10087, 9896, 9704, // 456
    9512, 9319, 9126, 8933, 8739, 8545, 8351, 8157, // 464
    7962, 7767, 7571, 7375, 7179, 6983, 6786, 6590, // 472
    6393, 6195, 5998, 5800, 5602, 5404, 5205, 5007, // 480
    4808, 4609, 4410, 4210, 4011, 3811, 3612, 3412, // 488
    3212, 3012, 2811, 2611, 2410, 2210, 2009, 1809, // 496
    1608, 1407, 1206, 1005, 804, 603, 402, 201, // 504
    0, -200, -401, -602, -803, -1004, -1205, -1406, // 512
    -1607, -1808, -2008, -2209, -2409, -2610, -2810, -3011, // 520
    -3211, -3411, -3611, -3810, -4010, -4209, -4409, -4608, // 528
    -4807, -5006, -5204, -5403, -5601, -5799, -5997, -6194, // 536
    -6392, -6589, -6785, -6982, -7178, -7374, -7570, -7766, // 544
    -7961, -8156, -8350, -8544, -8738, -8932, -9125, -9318, // 552
    -9511, -9703, -9895, -10086, -10277, -10468, -10658, -10848, // 560
    -11038, -11227, -11416, -11604, -11792, -11979, -12166, -12352, // 568
    -12538, -12724, -12909, -13093, -13278, -13461, -13644, -13827, // 576
    -14009, -14190, -14371, -14552, -14731, -14911, -15089, -15268, // 584
    -15445, -15622, -15799, -15975, -16150, -16324, -16498, -16672, // 592
    -16845, -17017, -17188, -17359, -17529, -17699, -17868, -18036, // 600
    -18203, -18370, -18536, -18702, -18867, -19031, -19194, -19356, // 608
    -19518, -19679, -19840, -19999, -20158, -20316, -20474, -20630, // 616
    -20786, -20941, -21095, -21249, -21402, -21553, -21704, -21855, // 624
    -22004, -22153, -22300, -22447, -22593, -22738, -22883, -23026, // 632
    -23169, -23310, -23451, -23591, -23730, -23869, -24006, -24142, // 640
    -24278, -24412, -24546, -24679, -24810, -24941, -25071, -25200, // 648
    -25328, -25455, -25581, -25707, -25831, -25954, -26076, -26197, // 656
    -26318, -26437, -26555, -26673, -26789, -26904, -27018, -27132, // 664
    -27244, -27355, -27465, -27574, -27682, -27789, -27895, -28000, // 672
    -28104, -28207, -28309, -28410, -28509, -28608, -28705, -28802, // 680
    -28897, -28991, -29084, -29176, -29267, -29357, -29446, -29533, // 688
    -29620, -29705, -29790, -29873, -29955, -30036, -30116, -30194, // 696
    -30272, -30348, -30423, -30497, -30570, -30642, -30713, -30782, // 704
    -30851, -30918, -30984, -31049, -31112, -31175, -31236, -31296, // 712
    -31355, -31413, -31469, -31525, -31579, -31632, -31684, -31735, // 720
    -31784, -31832, -31879, -31925, -31970, -32013, -32056, -32097, // 728
    -32136, -32175, -32212, -32249, -32284, -32317, -32350, -32381, // 736
    -32411, -32440, -32468, -32494, -32520, -32544, -32566, -32588, // 744
    -32608, -32627, -32645, -32662, -32677, -32691, -32704, -32716, // 752
    -32727, -32736, -32744, -32751, -32756, -32760, -32764, -32765, // 760
    -32766, -32765, -32764, -32760, -32756, -32751, -32744, -32736, // 768
    -32727, -32716, -32704, -32691, -32677, -32662, -32645, -32627, // 776
    -32608, -32588, -32566, -32544, -32520, -32494, -32468, -32440, // 784
    -32411, -32381, -32350, -32317, -32284, -32249, -32212, -32175, // 792
    -32136, -32097, -32056, -32013, -31970, -31925, -31879, -31832, // 800
    -31784, -31735, -31684, -31632, -31579, -31525, -31469, -31413, // 808
    -31355, -31296, -31236, -31175, -31112, -31049, -30984, -30918, // 816
    -30851, -30782, -30713, -30642, -30570, -30497, -30423, -30348, // 824
    -30272, -30194, -30116, -30036, -29955, -29873, -29790, -29705, // 832
    -29620, -29533, -29446, -29357, -29267, -29176, -29084, -28991, // 840
    -28897, -28802, -28705, -28608, -28509, -28410, -28309, -28207, // 848
    -28104, -28000, -27895, -27789, -27682, -27574, -27465, -27355, // 856
    -27244, -27132, -27018, -26904, -26789, -26673, -26555, -26437, // 864
    -26318, -26197, -26076, -25954, -25831, -25707, -25581, -25455, // 872
    -25328, -25200, -25071, -24941, -24810, -24679, -24546, -24412, // 880
    -24278, -24142, -24006, -23869, -23730, -23591, -23451, -23310, // 888
    -23169, -23026, -22883, -22738, -22593, -22447, -22300, -22153, // 896
    -22004, -21855, -21704, -21553, -21402, -21249, -21095, -20941, // 904
    -20786, -20630, -20474, -20316, -20158, -19999, -19840, -19679, // 912
    -19518, -19356, -19194, -19031, -18867, -18702, -18536, -18370, // 920
    -18203, -18036, -17868, -17699, -17529, -17359, -17188, -17017, // 928
    -16845, -16672, -16498, -16324, -16150, -15975, -15799, -15622, // 936
    -15445, -15268, -15089, -14911, -14731, -14552, -14371, -14190, // 944
    -14009, -13827, -13644, -13461, -13278, -13093, -12909, -12724, // 952
    -12538, -12352, -12166, -11979, -11792, -11604, -11416, -11227, // 960
    -11038, -10848, -10658, -10468, -10277, -10086, -9895, -9703, // 968
    -9511, -9318, -9125, -8932, -8738, -8544, -8350, -8156, // 976
    -7961, -7766, -7570, -7374, -7178, -6982, -6785, -6589, // 984
    -6392, -6194, -5997, -5799, -5601, -5403, -5204, -5006, // 992
    -4807, -4608, -4409, -4209, -4010, -3810, -3611, -3411, // 1000
    -3211, -3011, -2810, -2610, -2409, -2209, -2008, -1808, // 1008
    -1607, -1406, -1205, -1004, -803, -602, -401, -200, // 1016
    0, // 1024
};


// Harmonic number to note offset table [0] is f0, [1] is f0*2, ...
static const uint16_t HARMONICS_NOTE_OFFSET_TABLE[SYNTH_ADDITIVE_MAX_HARMONICS] {
    0, 3072, 4869, 6144, 7133, 7941, 8624, 9216, // 0
    9738, 10205, 10627, 11013, 11368, 11696, 12002, 12288, // 8
    12557, 12810, 13050, 13277, 13493, 13699, 13896, 14085, // 16
    14266, 14440, 14607, 14768, 14924, 15074, 15219, 15360, // 24
    15496, 15629, 15757, 15882, 16003, 16122, 16237, 16349, // 32
    16458, 16565, 16669, 16771, 16871, 16968, 17064, 17157, // 40
    17248, 17338, 17426, 17512, 17596, 17679, 17760, 17840, // 48
    17919, 17996, 18071, 18146, 18219, 18291, 18362, 18432, // 56
    18501, 18568, 18635, 18701, 18765, 18829, 18892, 18954, // 64
    19015, 19075, 19135, 19194, 19252, 19309, 19365, 19421, // 72
    19476, 19530, 19584, 19637, 19690, 19741, 19793, 19843, // 80
    19893, 19943, 19992, 20040, 20088, 20136, 20183, 20229, // 88
    20275, 20320, 20365, 20410, 20454, 20498, 20541, 20584, // 96
    20626, 20668, 20710, 20751, 20792, 20832, 20872, 20912, // 104
    20952, 20991, 21029, 21068, 21106, 21143, 21181, 21218, // 112
    21255, 21291, 21327, 21363, 21399, 21434, 21469, 21504, // 120
    21538, 21573, 21607, 21640, 21674, 21707, 21740, 21773, // 128
    21805, 21837, 21869, 21901, 21933, 21964, 21995, 22026, // 136
    22057, 22087, 22117, 22147, 22177, 22207, 22236, 22266, // 144
    22295, 22324, 22352, 22381, 22409, 22437, 22465, 22493, // 152
    22521, 22548, 22575, 22602, 22629, 22656, 22683, 22709, // 160
    22736, 22762, 22788, 22813, 22839, 22865, 22890, 22915, // 168
    22940, 22965, 22990, 23015, 23040, 23064, 23088, 23112, // 176
    23136, 23160, 23184, 23208, 23231, 23255, 23278, 23301, // 184
    23324, 23347, 23370, 23392, 23415, 23437, 23460, 23482, // 192
    23504, 23526, 23548, 23570, 23591, 23613, 23634, 23656, // 200
    23677, 23698, 23719, 23740, 23761, 23782, 23802, 23823, // 208
    23843, 23864, 23884, 23904, 23924, 23944, 23964, 23984, // 216
    24004, 24024, 24043, 24063, 24082, 24101, 24121, 24140, // 224
    24159, 24178, 24197, 24215, 24234, 24253, 24271, 24290, // 232
    24308, 24327, 24345, 24363, 24381, 24399, 24417, 24435, // 240
    24453, 24471, 24489, 24506, 24524, 24541, 24559, 24576, // 248
};

// sin() for 32-bit phase arg (using interpolation table) - returns 16-bit value in range -0x7fff..7fff
int16_t phaseSin_i16(uint32_t phase) {
    // top 10 bits of phase is table lookup index
    uint32_t index = phase >> 22;      // top 10 bits
    int32_t part = (phase >> 8) & 0x3fff; // 22-8 = 14 bits - part
    int32_t v0 = SIN_TABLE_1024_I16[index];
    int32_t v1 = SIN_TABLE_1024_I16[index+1];
    int32_t diff = ((v1 - v0) * part) >> 14; // up to 14 bits may be here
    // interpolated value
    return static_cast<int16_t>(v0 + diff);
}

// triangle generator
int16_t phaseTriangle_i16(uint32_t phase) {
    int16_t lowBits = (phase >> 15) & 0x7fff;
    switch(phase>>30) {
    default:
    case 0:
        return lowBits;
    case 1:
        return 0x7fff - lowBits;
    case 2:
        return -lowBits;
    case 3:
        return lowBits - 0x7fff;
    }
}

// sawtooth generator
int16_t phaseSawtooth_i16(uint32_t phase) {
    int16_t lowBits = (phase >> 16) & 0x7fff;
    if (phase & 0x80000000)
        return lowBits - 0x7fff;
    else
        return lowBits;
}

int32_t phaseSin_i24(uint32_t phase) {
    // top 10 bits of phase is table lookup index
    uint32_t index = phase >> 22;      // top 10 bits
    int32_t part = (phase >> 8) & 0x3fff; // 22-8 = 14 bits - part
    int32_t v0 = SIN_TABLE_1024_I[index];
    int32_t v1 = SIN_TABLE_1024_I[index+1];
    int32_t diff = ((v1 - v0) * part) >> 14; // up to 14 bits may be here
    // interpolated value
    return v0 + diff;
}


float phaseSin(uint32_t phase) {
    // top 10 bits of phase is table lookup index
    uint32_t index = phase >> 22;
    // bottom 22 bits of phase is part for interpolation
    float part = (phase & ((1<<22)-1)) * (1.0f / 0x400000);
    float v0 = SIN_TABLE_1024[index];
    float v1 = SIN_TABLE_1024[index+1];
    float diff = (v1 - v0) * part;
    return v0 + diff;
}

// get offset from base note (in note encoding scale) for harmonic N
uint16_t harmonicNoteOffset(int n) {
    return HARMONICS_NOTE_OFFSET_TABLE[n];
}

